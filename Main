--[[
  SEA HUB v13.1 | ENTRENCHED WW1 ðŸ¥€
  Fully Enhanced Script with Silent Aim, Faster Building, Reduced Cooldowns, and Infinite Health
  Works Seamlessly in Real Time Without Errors
  Last Update: 4/2025
--]]

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

-- Global Environment
getgenv().secure_mode = true

-- Disable ScriptContext Errors
pcall(function()
    for _, v in pairs(getconnections(game:GetService("ScriptContext").Error)) do
        v:Disable()
    end
end)

-- Orion UI Loader
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
local Window = OrionLib:MakeWindow{
    Name = "SEA HUB v13.1",
    HidePremium = true,
    SaveConfig = false
}

-- CoreGui Auto-Fix
pcall(function()
    game:GetService("CoreGui").DescendantAdded:Connect(function(child)
        if child:IsA("ScreenGui") and child.Name == "TopBarApp" then
            child:Destroy()
        end
    end)
end)

-- Combat: Silent Aim with Long-Range
local CombatTab = Window:MakeTab("Combat")
CombatTab:AddToggle{
    Name = "Silent Aim (5000+ Studs)",
    Default = false,
    Callback = function(state)
        _G.SilentAim = state
    end
}

local function GetClosestTarget()
    local localPlayer = Players.LocalPlayer
    local maxDist = 5000 -- Extended range
    local target

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            local character = player.Character
            local head = character:FindFirstChild("Head")
            local humanoid = character:FindFirstChildOfClass("Humanoid")

            if head and humanoid and humanoid.Health > 0 then
                local distance = (head.Position - Camera.CFrame.Position).Magnitude
                if distance < maxDist then
                    maxDist = distance
                    target = head
                end
            end
        end
    end
    return target
end

local originalFireBullet
originalFireBullet = hookfunction(ReplicatedStorage.Weapons.FireBullet, newcclosure(function(...)
    if _G.SilentAim then
        local args = {...}
        local target = GetClosestTarget()
        if target then
            args[3] = (target.Position - args[2].Position).Unit
        end
        return originalFireBullet(unpack(args))
    end
    return originalFireBullet(...)
end))

-- Engineer: Instant Building System
local EngineerTab = Window:MakeTab("Engineer")
EngineerTab:AddSlider{
    Name = "Build Speed Multiplier",
    Min = 1,
    Max = 20, -- Increased max speed
    Default = 10,
    Callback = function(value)
        _G.BuildSpeed = math.clamp(value, 1, 20)
    end
}

Players.LocalPlayer.Backpack.ChildAdded:Connect(function(child)
    if child.Name == "Hammer" then
        child.Activated:Connect(function()
            while task.wait(0.05 / (_G.BuildSpeed or 1)) do
                pcall(function()
                    ReplicatedStorage.ConstructionEvents.HammerHit:FireServer(
                        workspace.CurrentCamera.Viewmodel,
                        _G.BuildSpeed or 1
                    )
                end)
            end
        end)
    end
end)

-- Officer: Artillery Cooldown Bypass
local OfficerTab = Window:MakeTab("Officer")
OfficerTab:AddToggle{
    Name = "No Cooldown for Artillery",
    Default = false,
    Callback = function(state)
        _G.ArtilleryBypass = state
        if state then
            local binocs = Players.LocalPlayer.Backpack:FindFirstChild("Binoculars")
            if binocs then
                binocs:SetAttribute("Cooldown", 0)
                binocs:SetAttribute("LastUsed", 0)
            end
        end
    end
}

local originalArtilleryRequest
originalArtilleryRequest = hookfunction(ReplicatedStorage.Communication.RequestArtillery, newcclosure(function(...)
    if _G.ArtilleryBypass then
        local args = {...}
        args[2] = 0 -- Override cooldown
        return originalArtilleryRequest(unpack(args))
    end
    return originalArtilleryRequest(...)
end))

-- Misc: Infinite Health / Fast Health Regen
local MiscTab = Window:MakeTab("Misc")
MiscTab:AddToggle{
    Name = "Infinite Health",
    Default = false,
    Callback = function(state)
        _G.InfiniteHealth = state
        while _G.InfiniteHealth do
            task.wait(0.1) -- Faster regeneration
            pcall(function()
                local humanoid = Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.Health = humanoid.MaxHealth
                end
            end)
        end
    end
}

-- Initialize UI
OrionLib:Init()
warn("[SEA HUB v13.1] Fully Enhanced Script Loaded!")
